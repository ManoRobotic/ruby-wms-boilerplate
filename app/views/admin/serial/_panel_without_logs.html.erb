<div class="card-body space-y-4">
  <!-- Status -->
  <div class="status-section">
    <div class="flex items-center justify-between">
      <span class="font-medium">Estado:</span>
      <div class="flex items-center">
        <span data-serial-target="status" class="px-2 py-1 rounded text-sm font-medium bg-blue-100 text-blue-800">Iniciando...</span>
      </div>
    </div>
  </div>

  <!-- Scale Section -->
  <div class="scale-section">
    <h4 class="font-medium text-gray-700 mb-2">BÃ¡scula</h4>
    
    <div class="grid grid-cols-1 md:grid-cols-1 gap-4">
      <div>
        <label for="serial_port" class="block text-sm font-medium text-gray-700 mb-1">Puerto</label>
        <div class="flex gap-2">
          <select data-serial-target="scalePort" id="serial_port" 
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-md">
            <option value="">Detectando puertos...</option>
          </select>
          <button data-action="click->serial#refreshPorts" 
                  class="px-3 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-300 transition-colors">
            <i class="fa-solid fa-sync"></i>
          </button>
        </div>
        <div class="mt-2">
          <span class="text-xs text-gray-500">Estado:</span>
          <span data-serial-target="scaleStatus" class="px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800 ml-2">Desconectada</span>
        </div>
      </div>
      
      <div class="flex items-end space-x-2">
        <button data-action="click->serial#connectScale" 
                class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors">
          Conectar
        </button>
        <button data-action="click->serial#disconnectScale" 
                class="px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-md hover:bg-gray-700 transition-colors">
          Desconectar
        </button>
      </div>
    </div>

    <!-- Weight Display -->
    <div class="weight-section mt-4 p-4 bg-gray-50 rounded-lg">
      <div class="flex items-center justify-between">
        <span class="font-medium">Peso actual:</span>
        <button data-action="click->serial#readWeightNow" 
                data-serial-target="readButton"
                class="px-3 py-1 bg-white text-gray-700 text-sm font-medium rounded-md border border-gray-300 hover:bg-gray-50 transition-colors">
          Leer ahora
        </button>
      </div>
      <div data-serial-target="weight" class="weight-display mt-2">
        <div class="text-2xl font-bold text-center text-gray-400">--</div>
        <div class="text-sm text-center text-gray-500">--</div>
      </div>
    </div>
  </div>

  <!-- Printer Section -->
  <div class="printer-section">
    <h4 class="font-medium text-gray-700 mb-2">Impresora</h4>
    
    <div class="flex items-center justify-between mb-2">
      <span class="font-medium">Estado:</span>
      <span data-serial-target="printerStatus" class="px-2 py-1 rounded text-sm font-medium bg-blue-100 text-blue-800">Desconectada</span>
    </div>
    
    <div class="mb-4">
      <label for="printer_port" class="block text-sm font-medium text-gray-700 mb-1">Puerto</label>
      <div class="flex gap-2">
        <select data-serial-target="printerPort" id="printer_port" 
                class="flex-1 px-3 py-2 border border-gray-300 rounded-md">
          <option value="">Detectando puertos...</option>
        </select>
        <button data-action="click->serial#refreshPorts" 
                class="px-3 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-300 transition-colors">
          <i class="fa-solid fa-sync"></i>
        </button>
      </div>
      <div class="mt-2">
        <span class="text-xs text-gray-500">Estado:</span>
        <span data-serial-target="printerStatus" class="px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800 ml-2">Desconectada</span>
      </div>
    </div>
    
    <div class="grid grid-cols-2 gap-2">
      <button data-action="click->serial#connectPrinter" 
              class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors">
        Conectar
      </button>
      <button data-action="click->serial#testPrinter" 
              data-ancho="80"
              data-alto="50"
              class="px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-md hover:bg-gray-700 transition-colors">
        Test TSC
      </button>
    </div>
  </div>
</div>

<!-- Hidden forms for automatic saving -->
<%= form_with url: admin_configurations_auto_save_path, method: :post, local: true, id: "auto-save-serial-form", style: "display: none;" do |form| %>
  <%= form.hidden_field :serial_port, id: "auto-save-serial-port" %>
  <%= form.hidden_field :serial_baud_rate, id: "auto-save-serial-baud-rate" %>
  <%= form.hidden_field :serial_parity, id: "auto-save-serial-parity" %>
  <%= form.hidden_field :serial_stop_bits, id: "auto-save-serial-stop-bits" %>
  <%= form.hidden_field :serial_data_bits, id: "auto-save-serial-data-bits" %>
<% end %>

<%= form_with url: admin_configurations_auto_save_path, method: :post, local: true, id: "auto-save-printer-form", style: "display: none;" do |form| %>
  <%= form.hidden_field :printer_port, id: "auto-save-printer-port" %>
  <%= form.hidden_field :printer_baud_rate, id: "auto-save-printer-baud-rate" %>
  <%= form.hidden_field :printer_parity, id: "auto-save-printer-parity" %>
  <%= form.hidden_field :printer_stop_bits, id: "auto-save-printer-stop-bits" %>
  <%= form.hidden_field :printer_data_bits, id: "auto-save-printer-data-bits" %>
<% end %>