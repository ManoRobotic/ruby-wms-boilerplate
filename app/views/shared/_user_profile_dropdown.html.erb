<!-- User Profile - Discord Style -->
<div class="relative" data-controller="dropdown">
  <button data-dropdown-target="trigger" 
          data-action="click->dropdown#toggle"
          class="flex items-center w-full p-2 rounded-lg hover:bg-gray-700 focus:outline-none group">
    <!-- Avatar -->
    <div class="flex-shrink-0 w-7 h-7 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center mr-2">
      <span class="text-sm font-semibold text-white">
        <%= current_user_avatar_letter %>
      </span>
    </div>
    
    <!-- User Info -->
    <div class="flex-1 text-left">
      <div class="text-sm font-medium text-white truncate">
        <%= current_user_display_name %>
      </div>
      <div class="text-xs text-gray-300 truncate">
        <%= current_user_role_display %>
      </div>
    </div>

    <!-- Online Status -->
    <div class="relative flex-shrink-0 ml-2 mr-8">
      <span class="ml-14 mt-1 absolute inline-flex w-3 h-3 bg-green-500 rounded-full opacity-75 animate-ping"></span>
      <span class="ml-14 relative inline-flex w-3 h-3 bg-green-500 rounded-full"></span>
    </div>
  </button>
  
  <!-- User Menu Dropdown -->
  <div data-dropdown-target="menu" 
       class="hidden absolute bottom-full left-0 right-0 mb-2 bg-white rounded-lg shadow-lg border z-50"
       style="bottom: 100%; max-height: 30vh; overflow-y: auto;">
    <div class="p-3 border-b border-gray-200">
      <div class="flex items-center space-x-3">
        <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center">
          <span class="text-lg font-semibold text-white">
            <%= current_user_avatar_letter %>
          </span>
        </div>
        <div class="flex-1">
          <div class="text-sm font-medium text-gray-900">
            <%= current_user_display_name %>
          </div>
          <div class="text-xs text-gray-600">
            <%= current_user_display_email %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="py-2">
      <a href="#" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
        <%= icon('fa-solid', 'user', class: 'w-4 h-4 mr-3 text-gray-400') %>
        Mi Perfil
      </a>
      <a href="#" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
        <%= icon('fa-solid', 'cog', class: 'w-4 h-4 mr-3 text-gray-400') %>
        Configuraci√≥n
      </a>
      <div class="border-t border-gray-200 my-2"></div>
      <%= form_with url: destroy_admin_session_path, method: :delete, class: 'inline w-full' do %>
        <button type="submit" 
                class="flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50" 
                data-confirm="<%= t('admin.sidebar.logout_confirm') %>">
          <%= icon('fa-solid', 'sign-out', class: 'w-4 h-4 mr-3') %>
          <%= t('admin.sidebar.logout') %>
        </button>
      <% end %>
    </div>
  </div>
</div>