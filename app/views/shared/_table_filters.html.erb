<%# 
  Partial para filtros de tabla reutilizable
  Parámetros:
  - filters: array de hashes con la configuración de filtros
  - search_placeholder: texto del placeholder para el buscador
  - form_url: URL para el formulario
%>

<div class="bg-white p-3 rounded-md shadow-sm border border-gray-200 mb-4">
  <%= form_with url: local_assigns[:form_url] || request.path, method: :get, local: true, class: "space-y-3" do |form| %>
    
    <!-- Compact Search and Filters Row -->
    <div class="flex flex-col lg:flex-row gap-3 lg:items-end">
      
      <!-- Search Field -->
      <% if local_assigns[:search_placeholder] %>
        <div class="flex-1">
          <%= form.text_field :search, 
              value: params[:search], 
              placeholder: local_assigns[:search_placeholder],
              class: "w-full px-3 py-2.5 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
        </div>
      <% end %>

      <!-- Compact Filters -->
      <% unless (local_assigns[:filters] || []).empty? %>
        <div class="flex flex-wrap gap-2 lg:gap-3">
          <% (local_assigns[:filters] || []).each do |filter| %>
            <div class="min-w-0">
              <% case filter[:type] %>
              <% when 'select' %>
                <%= form.select filter[:name], 
                    options_for_select(filter[:options], params[filter[:name]]), 
                    { prompt: filter[:prompt] || filter[:label] },
                    { class: "px-3 py-2.5 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white min-w-32" } %>
              <% when 'date' %>
                <%= form.date_field filter[:name], 
                    value: params[filter[:name]],
                    class: "px-3 py-2.5 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-w-36" %>
              <% when 'checkbox' %>
                <div class="flex items-center px-3 py-2">
                  <%= form.check_box filter[:name], 
                      { checked: params[filter[:name]] == '1' },
                      '1', '0',
                      class: "rounded text-blue-600 focus:ring-blue-500" %>
                  <span class="ml-2 text-base text-gray-700"><%= filter[:label] %></span>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>

      <!-- Compact Action Buttons -->
      <div class="flex gap-2 shrink-0">
        <%= form.submit "Filtrar", 
            class: "bg-blue-600 text-white px-4 py-2.5 rounded-md text-base hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 transition-colors" %>
        <%= link_to "Limpiar", request.path, 
            class: "bg-gray-500 text-white px-4 py-2.5 rounded-md text-base hover:bg-gray-600 focus:ring-2 focus:ring-gray-500 transition-colors" %>
      </div>
    </div>

    <!-- Preserve other params -->
    <% params.except(:search, :controller, :action, :commit, :page, *(local_assigns[:filters] || []).map { |f| f[:name] }).each do |key, value| %>
      <%= form.hidden_field key.to_sym, value: value %>
    <% end %>

  <% end %>
</div>